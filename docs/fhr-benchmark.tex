\chapter{Fluoride-Salt-Cooled High-Temperature Reactor Benchmark}
\glsresetall
\label{chap:fhr-benchmark}
\gls{FHR} systems use \gls{TRISO} fuel and a low-pressure liquid fluoride-salt coolant.
\gls{FHR} technology combines \gls{FLiBe} coolant from \glspl{MSR} and 
\gls{TRISO} particles from \glspl{VHTR} to enable a reactor with 
low operating pressure, a large thermal margin, and accident-tolerant 
qualities.
Within the \gls{FHR} reactor class, \glspl{AHTR} have plate-based fuel in a hexagonal 
fuel assembly. 
In section \ref{sec:fhr}, I gave an \gls{FHR} concept overview, 
an \gls{AHTR} design description, a review of previous efforts 
towards modeling these designs, and how these efforts led to the \gls{FHR} benchmark
initiation. 

To address the \gls{AHTR} modeling challenges described in Chapter 
\ref{chap:lit-review}, such as multiple heterogeneity and material cross-section 
data, the \gls{OECD}-\gls{NEA} and \gls{Georgia Tech} initiated the \gls{FHR} 
benchmark for the \gls{AHTR} design in 2019 \cite{petrovic_benchmark_2021}. 
\gls{UIUC} participates in the \gls{FHR} benchmark with the OpenMC Monte Carlo code 
\cite{romano_openmc_2013} using the ENDF/B-VII.1 material cross section library 
\cite{chadwick_endf/b-vii.1_2011}.
The \gls{UIUC} team consists of myself and my advisors, Professor Kathryn Huff and Dr.
Madicken Munk. 

The three-phase \gls{FHR} benchmark begins with a single fuel assembly 
simulation without burnup and gradually extends to full core depletion. 
Table \ref{tab:phases} outlines the complete and incomplete benchmark phases as of 
August 2022.
\begin{table}[htbp]
    \centering
    \onehalfspacing
    \caption{\acrfull{OECD} \acrfull{NEA} \acrfull{FHR} benchmark Phases 
    \cite{petrovic_benchmark_2021}.}
	\label{tab:phases}
    \footnotesize
    \begin{tabular}{lclc}
    \hline 
    \textbf{Phases}& \textbf{Sub-phases} & \textbf{Description} & \textbf{Completed?} \\
    \hline
    \multirow{ 3}{5cm}{\textbf{Phase I: fuel assembly}} & I-A & 2D model, steady-state & \checkmark\\
    &I-B & 2D model depletion & \checkmark\\
    &I-C & 3D model depletion &\\
    \hline
    \multirow{2}{5cm}{\textbf{Phase II: 3D full core}}&II-A & Steady-state &\\
    &II-B & Depletion &\\
    \hline 
    \multirow{ 2}{5.5cm}{\textbf{Phase III: 3D full core with feedback \& multicycle analysis}}&III-A & Full core depletion with feedback &\\
    &III-B & Multicycle analysis &\\
    \hline
    \end{tabular}
\end{table}

In the subsequent sections, I will describe the benchmark's \gls{AHTR} design details
(Section \ref{sec:fhr-design} and Phase I specifications (Section \ref{sec:phase1}. 
Then, I will share our Phase I-A and I-B results generated with the OpenMC neutronics 
code \cite{romano_openmc_2013} (Section \ref{sec:fhr-phase1-results}) and the 
\gls{AHTR} temperature model's results (Section \ref{sec:fhr-bm-temp}).  
Appendix B lists all the data and analysis related to this chapter to enable the 
reproduction of all the simulations.

\section{FHR Benchmark \acrlong{AHTR} Design}
\label{sec:fhr-design}
Figure \ref{fig:reactor-schematic} shows the \acrfull{AHTR} schematic and a vertical 
cut of the reactor vessel. 
The \gls{AHTR} operates at 3400 MWt thermal power and 1400 MWe 
electric power \cite{varma_ahtr_2012}. 
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{reactor-schematic.png} 
    \caption{\acrfull{AHTR} schematic (left) and vessel (right) reproduced from
    \cite{petrovic_benchmark_2021}.}
    \label{fig:reactor-schematic}
\end{figure}
The $10m$-diameter exterior reactor vessel contains an $8m$-diameter 
reactor core that contains 252 hexagonal fuel assemblies.

Each $6m$ high fuel assembly comprises a $5.5m$ active core region containing
\gls{TRISO} particles and $0.25m$ top and bottom non-fuelled reflector regions.
Figure \ref{fig:ahtr}, from Chapter \ref{chap:lit-review}, shows a single 
hexagonal fuel assembly geometry and the arrangement of all assemblies in the core.
All dimensions specified are at room temperature. 
The benchmark's phases I and II use room temperature dimensions, while Phase III 
will address dimensional changes brought about by temperature expansion. 
Figure \ref{fig:ahtr-fuel-assembly} shows a x-y plane view of the 
\gls{AHTR}'s hexagonal fuel assembly. 
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.9\linewidth]{ahtr-fuel-element.png} 
    \resizebox{0.4\textwidth}{!}{
        \fbox{\begin{tabular}{ll}
            \textcolor{fhrblue}{$\blacksquare$} & FLiBe \\
            \textcolor{fhrgrey}{$\blacksquare$} & Graphite (Fuel Structure)\\
            \textcolor{fhrred}{$\blacksquare$} & Graphite (Fuel Plank) \\
            \textcolor{fhrpink}{$\blacksquare$} & Graphite (Spacers) \\
            \textcolor{fhrgreen}{$\blacksquare$} & Graphite (Fuel Stripe) \\
            \textcolor{fhryellow}{$\blacksquare$} & TRISO particle \\
            \end{tabular}}}
            \hspace{0.5cm}
            \begin{tikzpicture}
                \draw[ thick,-latex] (0,0) -- (1.3,0) node[anchor=south west] {$x$};
                \draw[ thick,-latex] (0,0) -- (0,1.3) node[anchor=south west] {$y$};
                \draw[ thick,-latex] (0,0) -- (1.3,1.3) node[anchor=south west] {$z$};
               \tkzText[above](-0.5,1){}
               \end{tikzpicture} 
    \caption{The \acrfull{FHR} benchmark's \acrfull{AHTR} fuel assembly with 18 fuel 
    planks (red) arranged in three diamond-shaped sectors, with a central Y-shaped and 
    external channel graphite structure (grey). 
    TRISO fuel (yellow) is arranged in a lattice structure within fuel stripes (green). 
    Spacers (pink) hold the graphite planks apart. 
    FliBe coolant flows through the assembly (blue). }
    \label{fig:ahtr-fuel-assembly}
\end{figure}
The hexagonal fuel assembly consists of eighteen fuel-containing graphite planks 
arranged in three diamond-shaped sectors, with an external channel wrapper and 
structural Y-shape, made of C-C composite with extra notches to hold the fuel 
planks in place. 
The diamond-shaped sections have $120^\circ{}$ rotational symmetry with each other 
\cite{varma_ahtr_2012,ramey_monte_2018,petrovic_benchmark_2021}. 
Semi-cylindrical graphite spacers attach to the fuel planks with a radius equalling to 
coolant channel thickness. 
\gls{FLiBe} coolant fills the gaps between the fuel planks and
assemblies (note: \gls{FLiBe} layer around the single assembly). 
The Y-shaped control rod slot at the center of the Y-shape structure contains 
\gls{FLiBe} coolant when the control blade is not in the slot (as seen in 
Figure \ref{fig:ahtr-fuel-assembly})
\cite{varma_ahtr_2012,ramey_monte_2018,petrovic_benchmark_2021}.
For a single fuel assembly, the internal $120^\circ{}$ rotational symmetry is 
represented by periodic boundary conditions, as seen in Figure \ref{fig:bc}. 
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.72\linewidth]{bc.png} 
    \begin{tikzpicture}
        \draw[ thick,-latex] (0,7) -- (1.3,7) node[anchor=south west] {$x$};
        \draw[ thick,-latex] (0,7) -- (0,8.3) node[anchor=south west] {$y$};
        \draw[ thick,-latex] (0,7) -- (1.3,8.3) node[anchor=south west] {$z$};
       \tkzText[above](-0.5,0){}
       \end{tikzpicture} 
    \caption{Visualization of periodic boundary conditions for a single fuel 
    assembly in the \acrfull{AHTR}, reproduced from \cite{petrovic_benchmark_2021}.}
    \label{fig:bc}
\end{figure}

Figure \ref{fig:ahtr-fuel-plank} magnifies a single fuel plank. 
Fuel stripes line the upper and lower sides of each graphite fuel plank. 
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{ahtr-fuel-plank.png} 
    \resizebox{0.4\textwidth}{!}{
        \fbox{\begin{tabular}{ll}
            \textcolor{fhrblue}{$\blacksquare$} & FLiBe \\
            \textcolor{fhrgrey}{$\blacksquare$} & Graphite (Fuel Structure)\\
            \textcolor{fhrred}{$\blacksquare$} & Graphite (Fuel Plank) \\
            \textcolor{fhrgreen}{$\blacksquare$} & Graphite (Fuel Stripe) \\
            \textcolor{fhryellow}{$\blacksquare$} & TRISO particle \\
            \textcolor{fhrpink}{$\blacksquare$} & Graphite (Spacer) \\
            \end{tabular}}}
            \hspace{0.5cm}
            \begin{tikzpicture}
                \draw[ thick,-latex] (0,0) -- (1.3,0) node[anchor=south west] {$x$};
                \draw[ thick,-latex] (0,0) -- (0,1.3) node[anchor=south west] {$y$};
                \draw[ thick,-latex] (0,0) -- (1.3,1.3) node[anchor=south west] {$z$};
               \tkzText[above](-0.5,1){}
               \end{tikzpicture} 
    \caption{\acrfull{AHTR}'s fuel plank, with the magnification of 
    a spacer and segment of the fuel stripe with embedded \gls{TRISO} particles.}
    \label{fig:ahtr-fuel-plank}
\end{figure}
Each fuel stripe contains a graphite matrix filled with a cubic lattice of 
\gls{TRISO} particles with 40\% packing fraction. 
The lattice is 210 \gls{TRISO} particles wide in the x-direction, four particles 
deep in the y-direction, and 5936 particles tall in the z-direction. 
Figure \ref{fig:ahtr-triso} shows the \gls{TRISO} particle's cross section, 
consisting of five layers: oxycarbide fuel kernel, porous carbon buffer, 
inner pyrolytic carbon, silicon carbide layer, and the outer pyrolitic carbon. 
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.6\linewidth]{ahtr-triso.png} 
    \caption{\acrlong{AHTR}'s TRISO particle schematic reproduced from 
    \cite{petrovic_benchmark_2021}.}
    \label{fig:ahtr-triso}
\end{figure}

The \gls{FHR} benchmark includes \gls{AHTR} configurations with burnable poisons 
and control rods to control reactivity. 
The burnable poisons consist of europium oxide ($Eu_2O_3$) and have a discrete
or integral (dispersed) option. 
Figure \ref{fig:discrete-poison} shows the discrete option with z-direction axially 
stacked small spherical $Eu_2O_3$ particles at five XY locations in each 
fuel plank. 
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.82\linewidth]{discrete-poison.png}
    \begin{tikzpicture}
        \draw[ thick,-latex] (0,0) -- (1,0) node[anchor=south west] {$x$};
        \draw[ thick,-latex] (0,0) -- (0,1) node[anchor=south west] {$y$};
        \draw[ thick,-latex] (0,0) -- (1,1) node[anchor=south west] {$z$};
       \tkzText[above](-0.3,-0.7){}
       \end{tikzpicture} 
    \caption{x-y plane's placement of axial burnable poisons in the \acrlong{AHTR} 
    plank \cite{petrovic_benchmark_2021}. The burnable poisons are stacked in 
    the z-direction.}
    \label{fig:discrete-poison}
\end{figure}
The integral options consist of $Eu_2O_3$ homogenously mixed with the graphite 
fuel plank (including the graphite in fuel stripes matrix and plank ends 
indented to structural sides, but excluding the graphite in spacers and 
graphite in TRISO particles).
The \gls{MHC} control rod inserts into the Y-shaped control rod slot, displacing
the \gls{FLiBe} that occupies the slot 
(shown in Figure \ref{fig:ahtr-fuel-assembly}). 
Detailed \gls{AHTR} geometry and material information can be found in the 
\gls{FHR} benchmark's specifications \cite{petrovic_benchmark_2021}.

\section{FHR Benchmark Phase I Specifications}
\label{sec:phase1}
The \gls{FHR} benchmark Phase I consists of three subphases.
First, the steady-state 2D model (Phase I-A), next, the depletion of one 2D \gls{FHR} fuel 
assembly (Phase I-B), and finally depletion of one 3D \gls{FHR} fuel assembly 
(Phase I-C).
Benchmark organizers have only released Phase I-A and I-B's specifications. 
Thus Phase I-C's specifications will be omitted in this section.

The benchmark requires the following results for Phases I-A and I-B:
\begin{enumerate}[label=(\alph*)]
    \item $k_{eff}$ (effective multiplication factor)
    \item reactivity coefficients: $\beta_{eff}$ (effective delayed neutron fraction), 
    $\alpha_D$ (doppler coefficient), $\alpha_{T, FliBe}$ (\gls{FLiBe} temperature 
    coefficient), $\alpha_{M}$ (moderator temperature coefficient)
    \item tabulated fission source distribution by one-fifth fuel stripe
    \item $\bar{\phi_1}, \bar{\phi_2}, \bar{\phi_3}$ (neutron flux averaged over 
    the whole model tabulated in three coarse energy groups)
    \item $\phi_1(\vec{x},\vec{y}), \phi_2(\vec{x},\vec{y}), \phi_3(\vec{x},\vec{y})$ 
    (neutron flux distribution in three coarse energy groups) 
    \item fuel assembly averaged neutron spectrum
\end{enumerate}
Next, I report the equations used to calculate these required results.  

\subsubsection{Reactivity Coefficients (b)}
I assumed one energy group and six delayed groups for $\beta_{eff}$. 
Reactivity coefficient, $\alpha$, is the change in reactivity ($\rho$) of the 
material per degree change in the material's temperature (T). 
I calculated each reactivity coefficient and its corresponding uncertainty 
with these equations: 
\begin{align}
    \label{eq:reactivity-coefficient}
    \frac{\Delta \rho}{\Delta T} &= 
    \frac{\rho_{T_{high}}-\rho_{T_{low}}}{T_{high}-T_{low}} \ [\frac{pcm}{K}] \\
    \delta \frac{\Delta \rho}{\Delta T} &= 
    \frac{\sqrt{\delta (\rho_{T_{high}})^2+(\delta \rho_{T_{low}})^2}}{T_{high}-T_{low}} \ [\frac{pcm}{K}] 
\end{align}

\subsubsection{Fission Source Distribution / Fission Density (c)}
I calculated \gls{FD} with OpenMC's \texttt{fission} tally score (f) 
for each region divided by the average \texttt{fission} tally score of all the regions:
\begin{align}
    FD_i &=  \frac{f_i}{f_{ave}}\ [-]\\
    \intertext{where}
    f_i &= \mbox{fission reaction rate in a single region i [reactions/src]} \nonumber \\
    f_{ave} &= \mbox{average of all $f_i$ [reactions/src]} \nonumber
\end{align}
The uncertainty calculations for $FD_i$ and $f_{ave}$: 
\begin{align}
    \delta FD_i &= |FD_i| \sqrt{\left(\frac{\delta f_i}{f_i}\right)^2+\left(\frac{\delta f_{ave}}{f_{ave}}\right)^2} \\
    \delta f_{ave} &= \frac{1}{N}\sqrt{\sum_i^Nf_i^2} \\
    \intertext{where}
    N &= \mbox{No. of fission score values} \nonumber
\end{align}

\subsubsection{Neutron Flux (d, e, f)}
OpenMC's \texttt{flux} score is normalized per source particle simulated, resulting 
in [$\frac{neutrons\ cm}{src}$] units.
This is an unnatural unit for system analysis, and thus to better compare OpenMC
results with other software results in the benchmark, I converted flux to 
[$\frac{neutrons}{cm^2s}$] units using the following equations:  
\begin{align}
    \Phi_c &= \frac{N \cdot \Phi_o}{V} \\
    N &= \frac{P\cdot\nu}{Q\cdot k} \\
    \intertext{where}
    \Phi_c &= \mbox{converted flux [$\frac{neutrons}{cm^2s}$]} \nonumber \\ 
    \Phi_o &= \mbox{original flux [$\frac{neutrons\ cm}{src}$]} \nonumber \\
    N &= \mbox{normalization factor [$\frac{src}{s}$]} \nonumber \\
    V &= \mbox{volume of fuel assembly [$cm^3$]} \nonumber \\
    P &= \mbox{power [$\frac{J}{s}$]} \nonumber \\
    \nu &= \mbox{$\frac{\nu_f}{f}$ [$\frac{neutrons}{fission}$]} \nonumber \\
    Q &= \mbox{Energy produced per fission [$\frac{J}{fission}$]} \nonumber \\
    &= \mbox{$3.2044 \times 10^{-11}$ J per $U_{235}$ fission} \nonumber \\
    k &= \mbox{$k_{eff}$ [$\frac{neutrons}{src}$]} \nonumber 
\end{align}
The flux standard deviation is: 
\begin{align}
    \delta \Phi_c = \Phi_c \times
    \sqrt{(\frac{\delta \Phi_o}{\Phi_o})^2+ (\frac{\delta \nu_f}{\nu_f})^2 
    + (\frac{\delta k}{k})^2 + (\frac{\delta f}{f})^2}
\end{align}
I calculated reactor power based on the given reference specific power 
($P_{sp}$) of 200 $\frac{W}{gU}$: 
\begin{align}
    P &= P_{sp} \times V_F \times \rho_F \times \frac{wt\%_{U}}{100} \\
    \intertext{where}
    V_F &= \mbox{volume of fuel [$cm^3$]} \nonumber \\ 
    &= \frac{4}{3} \pi r_f^3 \times N_{total} \nonumber \\
    r_f &= \mbox{radius of fuel kernel within TRISO particle [cm]} \nonumber\\
    N_{total} &= \mbox{total no. of TRISO particles in fuel assembly} \nonumber \\ 
    &= 101 \times 210 \times 4 \times 2 \times 6 \times 3 \nonumber\\ 
    \rho_F &= \mbox{density of fuel [$g/cc$]} \nonumber \\
    wt\%_{U} &= \frac{at\%_{U235} \times m_{U235} + at\%_{U238} \times m_{U238}}{\sum (at\%_i \times m_i)} \times 100 \nonumber\\
    m &= \mbox{atomic mass} \nonumber
\end{align}

\subsection{Phase I-A Specifications}
For Phase I-A, the benchmark specifies that each participant must produce a 
steady-state 2D model of one fresh fuel assembly for nine cases
and report the required results listed in Section \ref{sec:phase1}.  
Table \ref{tab:phase1a-cases} describes each case. 
\begin{table}[htbp]
    \centering
    \onehalfspacing
    \caption{Description of the \acrlong{FHR} benchmark Phase I-A cases 
    \cite{petrovic_benchmark_2021}.}
    \footnotesize
	\label{tab:phase1a-cases}
    \begin{tabular}{p{0.05\textwidth}p{0.9\textwidth}}
    \hline 
    \textbf{Case} & \textbf{Description} \\
    \hline
    1A & Reference case. Hot full power (HFP), with temperatures of 1110K for 
    fuel kernel and 948K for coolant and all other materials (including TRISO 
    particle layers other than fuel kernel). Nominal (cold) dimensions, 
    9 wt\% enrichment, no \acrlong{BP}, \acrlong{CR} out.\\
    \hline
    2AH & \Gls{HZP} with uniform temperature of 948 K, 
    otherwise same as Case 1A. Comparison with Case 1A provides HZP-to-HFP power 
    defect.\\
    \hline 
    2AC & \Gls{CZP}. Same as Case 2AH, but with uniform temperature 
    of 773 K. Comparison with Case 2AH provides isothermal temperature coefficient.\\
    \hline
    3A & \Acrlong{CR} inserted, otherwise same as Case 1A. \\
    \hline
    4A & Discrete europia \acrlong{BP}, otherwise same as Case 1A.\\
    \hline
    4AR & Discrete europia \acrlong{BP} and \acrlong{CR} inserted, otherwise same as 
    Case 1A. \\
    \hline
    5A & Integral (dispersed) europia \acrlong{BP}, otherwise same as Case 1A. \\
    \hline
    6A & Increased \gls{HM} loading (4 to 8 layers of \gls{TRISO}) decreased C/HM 
    ratio (from about 400 to about 200) and decreased specific power to 100 W/gU, 
    otherwise same as Case 1A.\\
    \hline 
    7A & Fuel enrichment 19.75 wt\%, otherwise same as Case 1A.\\
    \hline 
    \end{tabular}
\end{table}

\subsection{Phase I-B Specifications}
For Phase I-B, the benchmark specifies that each participant must produce 
depletion results for three cases: 1B, 4B, and 7B. 
These are the same as cases 1A, 4A, and 7A (described in Table \ref{tab:phase1a-cases}), 
but with depletion steps added. 
The depletion steps are 0, 0.1, 0.5, 1, 2, 4, 6, 8, 10, 14, 18, 22, 26, 30, 40, 50, 
60, and 70 GWd/tU. 
Case 7B adds seven more depletion steps: 80, 90, 100, 120, 140, and 160 GWd/tU. 
The benchmark assumes that depletion occurs only in the fuel and burnable poisons 
and that the depletion performs under the critical spectrum assumption. 

\section{FHR Benchmark Phase I Results}
\label{sec:fhr-phase1-results}
The \texttt{arfc/fhr-benchmark} Github repository contains all the results submitted 
by \gls{UIUC} for the \gls{FHR} benchmark \cite{chee_arfcfhr-benchmark_2021}. 
The benchmark used a phased blind approach -- participants were asked to 
submit Phase I-A and I-B results without knowledge of other submissions. 
Petrovic et al. \cite{petrovic_preliminary_2021} describes the preliminary 
results of the benchmark across several institutions and concludes 
that the overall observed agreement is satisfactory. 
In the subsequent sections, I will share the results obtained by \gls{UIUC}. 

\subsection{Results: Phase I-A}
\label{sec:fhr-benchmark-results-ia}
In an \gls{ANS} Mathematics \& Computation (M$\&$C) 2021 conference, 
Petrovic et al. \cite{petrovic_preliminary_2021} 
compared \gls{FHR} benchmark participants' Phase I-A $k_{eff}$ results.  
We reported that the standard deviation between participants for each case 
was in the 231 to 514 pcm range, acceptable and notably close given a blind 
benchmark, assuring that \gls{UIUC}'s Phase I-A results are acceptable and 
in agreement with other benchmark participants. 

\subsubsection{Results: Effective Multiplication Factor (a)}
\label{sec:fhr-benchmark-keff}
Table \ref{tab:phase1a-results} reports Phase I-A $k_{eff}$ results. 
I ran the simulations on \gls{UIUC}'s BlueWaters supercomputer with 64 XE nodes, 
which each have 32 cores \cite{ncsa_about_2017}. 
To reduce the statistical uncertainty of $k_{eff}$ to $\sim$10pcm, I ran each 
simulation with 500 active cycles, 100 inactive cycles, and 200000 neutrons. 
Each simulation took \gls{WCT} ranging from 2 to 5 hours. 
\begin{table}[htbp]
    \centering
    \onehalfspacing
    \caption{\gls{UIUC}'s \acrlong{FHR} Benchmark Phase I-A results 
    \cite{chee_arfcfhr-benchmark_2021}.}
	\label{tab:phase1a-results}
    \footnotesize
    \begin{tabular}{cp{2.7cm}cccccc}
    \hline
    \textbf{Case} & \textbf{Summary} & \textbf{WCT [hr]} & \textbf{$k_{eff}$}* & 
    \textbf{$\beta_{eff}$}** & 
    \textbf{Fuel} $\frac{\Delta \rho}{\Delta T}$ & 
    \textbf{FliBe} $\frac{\Delta \rho}{\Delta T}$ & 
    \textbf{Graphite} $\frac{\Delta \rho}{\Delta T}$\\
    \hline 
    1A & Reference &2.82&1.39389 & 0.006534 & -2.24$\pm$0.15 & -0.15$\pm$0.15 & -0.68$\pm$0.15\\
    2AH & \gls{HZP} &2.82&1.40395 & 0.006534 & -3.14$\pm$0.15 & -0.20$\pm$0.14 & -0.85$\pm$0.14\\
    2AC & \gls{CZP} &2.75&1.41891 & 0.006534 & -3.36$\pm$0.14 & -0.11$\pm$0.14 & 0.07$\pm$0.14\\
    3A & CR &2.49&1.03147 & 0.006534 & -4.03$\pm$0.28 & -0.83$\pm$0.27 & -3.18$\pm$0.29\\
    4A & Discrete BP &5.08&1.09766 & 0.006542 & -4.06$\pm$0.24 & -1.55$\pm$0.23 & -6.51$\pm$0.24\\
    4AR & Discrete BP + CR &4.59&0.84158 & 0.006553 & -5.60$\pm$0.49 & -1.78$\pm$0.46 & -10.44$\pm$0.47\\
    5A & Dispersed BP &2.33&0.79837 & 0.006556 & -5.09$\pm$0.40 & -4.87$\pm$0.40 & -22.99$\pm$0.38\\
    6A & Increased \gls{HM} &3.52&1.26294 & 0.006556 & -4.46$\pm$0.19 & 0.16$\pm$0.20 & -0.39$\pm$0.20\\
    7A & 19.75\% Enriched &2.21&1.50526 & 0.006530 & -2.49$\pm$0.13 & -0.12$\pm$0.12 & -0.62$\pm$0.12\\
    \hline
    \multicolumn{5}{l}{BP: burnable poison, CR: control rod} \\
    \multicolumn{5}{l}{* All $k_{eff}$ values have an uncertainty of 0.00010.} \\
    \multicolumn{5}{l}{** All $\beta_{eff}$ values have an uncertainty of 0.000001.}
    \end{tabular}
\end{table}

Cases 2AH and 2AC are at zero power, meaning that the fuel assembly is exactly 
critical but not producing any energy. 
For both cases, $k_{eff}$ is higher than the reference Case 1A, which I attribute to 
lower fuel temperatures. 
At lower fuel temperatures, less doppler broadening occurs, resulting in less neutron 
capture, thus, increasing $k_{eff}$. 
As expected, $k_{eff}$ is lower for Cases 3A, 4AR, and 5A than reference case 
1A since these cases introduce burnable poisons and control rods to the fuel 
assembly. 
Also, as expected, $k_{eff}$ is higher for Case 7A than reference Case 1A since 
it has a higher enrichment. 
However, Case 6A deviated from expectations with a lower $k_{eff}$ despite an increase 
in \acrlong{HM} loading. 
This behavior is due to reduced moderation and worsened fuel utilization brought about 
by self-shielding, demonstrating that increased fuel packing fraction does not 
always correspond with an increased $k_{eff}$. 

\subsubsection{Results: Reactivity Coefficients (b)}
Table \ref{tab:phase1a-results} reports Phase I-A reactivity coefficients results. 
$\beta_{eff}$ increased by 10-20 [pcm] for Cases 4A, 4AR, 5A, and 6A compared to
reference Case 1A due to the introduction of control rods and poisons that 
shift the average neutron velocity to higher values, resulting in decreased
thermal fission and increased fast fission \cite{torabi_neutronic_2018}.
In Table \ref{tab:phase1a-results}, most temperature coefficients are negative, 
exemplifying the \gls{AHTR}'s passive safety behavior. 
Negative reactivity feedback results in a self-regulating reactor; if the reactor 
power rises, resulting in a temperature increase, the negative reactivity
reduces power. 

\subsubsection{Results: Fission Source Distribution (c)}
Figure \ref{fig:phase1a-c} shows Cases 1A and 3A's fission source distribution 
discretized by one-fifth fuel stripe. 
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.49\linewidth]{p1a_c1a_c.png} 
    \includegraphics[width=0.49\linewidth]{p1a_c3a_c.png} 
    \includegraphics[width=0.49\linewidth]{p1a_c6a_c.png} 
    \caption{\gls{UIUC} \gls{FHR} benchmark results: normalized Fission Source 
    Distribution [-] per one-fifth fuel stripe for \acrlong{FHR} Benchmark's Phase I-A 
    Case 1A (top left), Case 3A (top right), and Case 6A (bottom).}
    \label{fig:phase1a-c}
\end{figure}
Case 4AR has a similar fission source distribution to Case 3A since both 
cases have control rod insertion. 
Case 7A has a similar fission source distribution to case 6A since both have 
higher heavy metal loading. 
All other cases have similar fission source distributions to Case 1A. 

For Case 1A, intuitively, one might assume that the highest fission source would 
occur in the center of the diamond fuel segment; however, the opposite is true. 
Power peaking occurs on exterior stripes and is minimum on the interior stripes.
Gentry et al. \cite{gentry_development_2016} reported similar power peaking 
phenomena towards the lattice cell's exterior closest to the Y-shaped carbon 
support structure.  
This fission source distribution is caused by diminished resonance escape 
probability in the interior due to the higher relative fuel-to-carbon volume 
ratio. 

For Case 3A with an inserted control rod, the fission source is lower in 
the one-fifth stripes closer to the control rod.  
Case 6A demonstrates a further diminished fission source in the interior 
stripes due to the higher fuel-to-carbon ratio.
This is seen in Figure \ref{fig:phase1a-c}, in which case 1A and 6A have similar 
fission distribution trends, but case 6A has a bigger fission source value range. 

\subsubsection{Results: Average Neutron Flux (d)}
Figure \ref{fig:phase1a-d} shows the average neutron flux in the fuel assembly in 
three coarse energy groups. 
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{phase1a-d-flux.png} 
    \caption{\gls{UIUC} \gls{FHR} benchmark results: neutron flux, 
    averaged over the whole model, tabulated in three coarse energy groups for 
    each Phase I-A case. Neutron flux uncertainty is on the order of 1e10.}
    \label{fig:phase1a-d}
\end{figure}
Most cases have the most flux in the intermediate group, followed by 
the thermal group, and the least flux in the fast group.   

\subsubsection{Results: Neutron Flux Distribution (e)}
Figure \ref{fig:phase1a-e} shows the neutron flux distribution in a 100 $\times$ 
100 mesh for Cases 1A, 3A, and 6A for three coarse energy groups. 
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{phase1a-e-c1a.png} 
    \includegraphics[width=\linewidth]{phase1a-e-c3a.png} 
    \includegraphics[width=\linewidth]{phase1a-e-c6a.png} 
    \caption{\gls{UIUC} \gls{FHR} benchmark flux results: neutron flux 
    distribution in 100 $\times$ 100 mesh for three coarse energy groups: Case 
    1A (above), Case 3A (middle), Case 6A (below). Energy group 1: $E > 0.1$ MeV, 
    Energy group 2: $3 \times 10^{-6} < E < 0.1$ MeV, Energy group 3: $E < 3 \times 10^{-6}$ MeV. }
    \label{fig:phase1a-e}
\end{figure}
% TODO: add axes labels and bigger... 
For all three cases, fast-flux (energy group 1) peaks in the diamond-shaped sectors containing 
the fuel stripes, whereas thermal flux (energy group 3) peaks outside the diamond-shaped 
sectors. 
This can be attributed to fission occurring at thermal energies in the fuel stripe area. 
For Case 3A, the thermal and intermediate neutron flux is depressed in the fuel 
assembly's control rod region.  
An increased heavy metal loading in Case 6A results in a more pronounced 
fast-flux peaking and thermal flux dip in the fuel stripe area. 

\subsubsection{Results: Neutron Spectrum (f)}
Figure \ref{fig:phase1a-f} shows the neutron spectrum for Cases 1A and 6A. 
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.49\linewidth]{p1a_c1a_f.png} 
    \includegraphics[width=0.49\linewidth]{p1a_c6a_f.png} 
    \caption{\gls{UIUC} \gls{FHR} benchmark results: neutron spectrum for 
    Phase I-A Case 1A (left) and Case 6A (right).}
    \label{fig:phase1a-f}
\end{figure}
% todo: increase label sizes... 
Case 7A has a similar neutron spectrum to Case 6A since both cases have 
higher fuel content. 
All other cases have a similar neutron spectrum to Case 1A.
The neutron spectra in Cases 6A and 7A are faster due to more heavy metal 
loading and higher enrichment, respectively.  

\subsection{Results: Phase I-B}
\label{sec:fhr-benchmark-results-ib}
Figure \ref{fig:phase1b_keff} shows the $k_{eff}$ evolution during depletion 
for Cases 1B, 4B, and 7B.
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{phase1b_keff.png} 
    \caption{\gls{UIUC} \gls{FHR} benchmark results: Phase I-B depletion 
    $k_{eff}$ evolution for Cases 1B, 4B, and 7B. Case 1B is the reference case, 
    Case 4B is the discrete \acrlong{BP} case, and Case 7B is the 19.75$\%$ 
    enrichment case. Error bars are included but are barely visible due to the 
    low $\sim$60pcm uncertainty.}
    \label{fig:phase1b_keff}
\end{figure}
The $k_{eff}$ at zero burnup corresponds to each case's Phase I-A $k_{eff}$ value 
reported in Table \ref{tab:phase1a-results}. 
Case 1B is the reference case with $9\%$ fuel enrichment and no \glspl{BP}. 
Case 1B's $k_{eff}$ steadily decreases until it reaches 0.967845 at the final 70 
GWd/tU burnup. 
Case 4B includes burnable poisons resulting in a lower initial $k_{eff}$. 
Case 4B's $k_{eff}$ decreases at a slower rate in the beginning due to the presence of 
burnable poisons, which decreases the flux in the core. 
At approximately 20 GWd/tU, $k_{eff}$ begins decreasing faster, presumably
due to burn-up of the poison material.   
Case 7B has a $19.75\%$ fuel enrichment, resulting in a higher initial $k_{eff}$. 
With a higher enrichment, the assembly stays critical till 140 Gwd/tU. 

\section{FHR Benchmark Temperature Model}
\label{sec:fhr-bm-temp}
I used Moltres \cite{lindsay_moltres_2017} to conduct \gls{AHTR} full assembly 
temperature simulations. 
AHTR Moltres simulations will capture thermal feedback effects absent from the purely 
neutronics OpenMC simulations conducted in the \gls{FHR} benchmark's Phase I-A.
To run Moltres simulations, the user provides group constant data from a neutron 
transport solver, such as OpenMC, for the Moltres multigroup neutron diffusion 
calculations and a mesh file representing the reactor geometry. 
In the following subsections, I will describe the steps conducted to produce the 
\gls{AHTR} temperature model with Moltres:
\begin{itemize}
    \item OpenMC neutronics model produces group constants data for the Moltres model
    \item Moltres model mesh generation
    \item Run Moltres model to calculate temperature distribution in the system 
    (Moltres model accepts group constants data and mesh) 
\end{itemize}

\subsection{FHR Benchmark: Group Constant Generation}
\label{sec:fhr-bm-group-constant}
Unlike the OpenMC neutronics model from the previous sections, Moltres does not 
explicitly model each \gls{TRISO} particle. 
Because I am using Moltres for temperature distributions and not neutron transport, 
a TRISO-level fidelity mesh file is impractical and results in extremely long Moltres 
simulation runtimes.
Instead, Moltres relies on the OpenMC model to generate group constants data
for the Moltres simulations. 
Previously, Moltres could only generate group constant data from Serpent 
\cite{leppanen_serpent_2014} or SCALE \cite{bucholz_scale:_1982} output files. 
I implemented functionality in Moltres for group constant data generation with 
OpenMC \cite{lindsay_moltres_2017}. 

To enable successful Moltres \gls{AHTR} temperature model simulations, I established 
suitable spatial and energy homogenization for group constant generation.
These homogenizations preserve accuracy while maintaining an acceptable runtime.
I used eight precursor groups and a four-group energy structure derived by Gentry et al. 
\cite{gentry_development_2016} for \gls{AHTR} geometries.
Table \ref{tab:energy_structures-bm} defines the 4-group energy boundaries. 
\begin{table}[htbp]
    \centering
    \onehalfspacing
    \caption{4-group energy structures for \acrfull{AHTR} geometry 
    derived by Gentry et al. \cite{gentry_development_2016}.}
	\label{tab:energy_structures-bm}
    \footnotesize
    \begin{tabular}{lll}
    \hline
    \multicolumn{3}{c}{\textbf{Group Boundaries [MeV]}} \\ 
    \hline
    \textbf{Group $\#$}& \textbf{Upper Bound} & \textbf{Lower Bound}  \\
    \hline 
    1 & $2.0000\times 10^1$ & $9.1188\times 10^{-3}$ \\ 
    2 & $9.1188\times 10^{-3}$ & $2.9023\times 10^{-5}$\\
    3 & $2.9023\times 10^{-5}$ & $1.8554\times 10^{-6}$\\
    4 & $1.8554\times 10^{-6}$ & $1.0000\times 10^{-12}$\\
    \hline
    \end{tabular}
\end{table}
For spatial homogenization of the \gls{AHTR} fuel assembly, I used OpenMC's \textit{cell} 
domain type to compute multigroup cross sections for different \textit{cells}.
I discretized the fuel assembly into 61 \textit{cells}: inter-assembly \gls{FLiBe}, Y-shaped 
graphite structure, control rod slot \gls{FLiBe}, graphite spacers, each diamond shape section's 
inter-plank \gls{FLiBe} (3), each graphite plank (18), and each fuel stripe (36).
I used reflective boundary conditions.
Figure \ref{fig:assembly_mg} illustrates the \gls{AHTR} assembly's spatial 
homogenization used for group constant generation.
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{assembly_mg.png}
    \raggedright
    \resizebox{0.5\textwidth}{!}{
        \hspace{1cm}
        \fbox{\begin{tabular}{ll}
            \textcolor{fhrblue1}{$\blacksquare$} & inter-assembly \gls{FLiBe} \\
            \textcolor{fhrgrey1}{$\blacksquare$} & Y-shaped graphite structure \\
            \textcolor{fhrblue2}{$\blacksquare$} & control rod slot \gls{FLiBe} \\
            \textcolor{fhrblue3}{$\blacksquare$} & inter-plank \gls{FLiBe} \\
            \textcolor{fhrpink1}{$\blacksquare$} & spacers \\
            \textcolor{fhrred1}{$\blacksquare$} & graphite planks \\
            \textcolor{fhrblack1}{$\blacksquare$} \textcolor{fhrwhite1}{$\blacksquare$} & fuel stripes
            \end{tabular}}}
    \caption{\acrfull{AHTR} assembly spatially discretized into 
    61 \textit{cells} for OpenMC multigroup calculation to produce group constants 
    data for the Moltres model.
    61 \textit{cells}: inter-assembly \gls{FLiBe}, Y-shaped graphite structure, control 
    rod slot \gls{FLiBe}, graphite spacers, each diamond shape section's inter-plank 
    \gls{FLiBe} (3), each graphite plank (18), and each fuel stripe (36).
     The white line corresponds to the centerline where flux distribution is measured.}
    \label{fig:assembly_mg}
\end{figure}

With the above-described energy discretization and spatial homogenization, I generated 
group constants with Moltres using four OpenMC simulations at 948K, 1024K, 1100K, and 
1200K. 
The OpenMC simulations are run with 80 active cycles, 20 inactive cycles, and 8000 
particles resulting in an uncertainty of $\sim 150pcm$.
In the next subsection, I compare the key neutronics parameters for the continuous 
OpenMC and multigroup Moltres simulations for the \gls{AHTR} assembly at 948K to 
ensure that the spatial homogenization and energy discretization preserve accuracy. 

\subsubsection{FHR Benchmark: Key Neutronics Parameters Verification}
In this section, I verify that the spatial homogenization and energy discretization 
I chose are acceptable by verifying key neutronics parameters.
I compare the key neutronics parameters between two simulations:
\begin{enumerate}
    \item OpenMC simulation with continuous energy and TRISO-level spatial fidelity 
    \item Moltres simulation with 4-group energy and spatial homogenization
\end{enumerate}
All materials' in the OpenMC simulation are 948K. 
The OpenMC simulation with TRISO-level fidelity generates the group constants for the 
energy and spatially homogenized Moltres simulation. 
I compare the following key neutronics parameters: effective multiplication factor, 
reactivity coefficients, flux distribution, and neutron energy spectrum. 
The comparisons are to verify that the Moltres model is replicating the OpenMC 
model's neutronics correctly.
And of these, comparisons of the reactivity coefficients and flux distributions 
are key to ensuring that Moltres accurately calculates the \gls{AHTR}'s 
temperature distribution.
The reactivity coefficients capture temperature reactivity feedback on the flux 
when the temperature varies with space in the Moltres model. 
The heat produced per fission, $\epsilon_{f,g}$, and macroscopic cross section 
for fission, $\Sigma_{f,g}$, terms in the Moltres source term (Equation 
\ref{eq:moltres-source-term}) are provided to Moltres through 
the group constants generated by the transport software, OpenMC.
Thus, differences in the source term between OpenMC and Moltres are dependent on 
the flux. 

\paragraph{Effective Multiplication Factor}
Comparing $k_{eff}$ and reactivity produced by Moltres and OpenMC verify that the 
Moltres model replicates the OpenMC model's neutronics correctly.
Table \ref{tab:keff_assem_comparison} compares the effective multiplication factor 
($k_{eff}$) and reactivity ($\rho$)
for OpenMC simulation with continuous energy and TRISO-level spatial fidelity, 
OpenMC simulation with 4-group energy and spatial homogenization, 
and Moltres simulation with 4-group energy and spatial homogenization.
I include results from the homogenized OpenMC simulation to 
distinguish between differences caused by spatial homogenization and energy 
discretization or differing OpenMC and Moltres solve methods. 
\begin{table}[htbp]
    \centering
    \onehalfspacing
    \caption{\acrfull{AHTR} assembly's $k_{eff}$ and reactivity values from the 
    OpenMC simulation with continuous energy and TRISO-level spatial fidelity, 
    OpenMC simulation with 4-group energy and spatial homogenization, and Moltres 
    simulation with 4-group energy and spatial homogenization. 
    All simulations are at 948K.
    The normalized difference is the pcm difference normalized by OpenMC non-homogenized 
    model's $k_{eff}$.}
	\label{tab:keff_assem_comparison}
    \footnotesize
    \begin{tabular}{lllclc}
    \hline 
    \textbf{Software}& \textbf{Homogenized?}& \textbf{$k_{eff}$} & \textbf{Diff [pcm]}  
    & \textbf{Reactivity [pcm]} & \textbf{Reactivity Diff [pcm]} \\
    \hline 
    OpenMC & No & $1.39850 \pm 0.00126$ & - & $28495 \pm 64$ & - \\ 
    OpenMC & Yes & $1.398373 \pm 0.00115$ & \Minus13 & $28488 \pm 58$ & \Minus6\\ 
    Moltres & Yes & $1.40273 $ & \Plus423 & 28710 & \Plus 216\\ 
    \hline
    \end{tabular}
\end{table}

The 9pcm $k_{eff}$ difference between continuous and homogenized OpenMC 
simulations is within uncertainty, showing that the selected spatial homogenizations
and energy discretizations are acceptable. 
However, there is a 302pcm difference in the Moltres simulation's $k_{eff}$. 
A possible reason is that the neutron diffusion method used in Moltres 
does not approximate this reactor geometry as well. 
The diffusion coefficients for this reactor type are approximately 1cm. 
The \gls{FLiBe} coolant channel has a 0.7cm width which is smaller than the diffusion
coefficient, resulting in poor approximations. 
The $k_{eff}$ values are acceptable since I am not using the Moltres simulation for 
neutronics modeling but for \gls{AHTR} assembly temperature modeling. 

\paragraph{Reactivity Coefficients}
Moltres' delayed neutron fraction, $\beta{eff}$, is calculated by taking the 
normalized difference between $k_{eff}$ values with and without \glspl{DNP}. 
Table \ref{tab:ahtr_full_assem_moltres_coeffs} shows that the $\beta{eff}$ values from 
OpenMC and Moltres show excellent agreement with a discrepancy of 0.84pcm. 
I calculated the temperature reactivity coefficients using Equation 
\ref{eq:reactivity-coefficient}.
Temperature reactivity feedback arises mainly from Doppler broadening of 
resonance absorption peaks and thermal expansion.
Table \ref{tab:ahtr_full_assem_moltres_coeffs} also shows that the total temperature 
coefficients from OpenMC and Moltres have good agreement with a discrepancy of 
0.43 pcm/K.
\begin{table}[htbp]
    \centering
    \onehalfspacing
    \caption{\acrfull{AHTR} assembly's $\beta_{eff}$ values from OpenMC and Moltres 
    simulations at 948K and total reactivity coefficient values calculated from 
    OpenMC and Moltres at 948K and 1100K.
    The OpenMC simulation has continuous energy and TRISO-level spatial fidelity, and the
    Moltres simulation has 4-group energy and spatial homogenization.}
    \footnotesize
	\label{tab:ahtr_full_assem_moltres_coeffs}
    \begin{tabular}{llllll}
    \hline 
    \textbf{Software}& \textbf{Homogenized?}& \textbf{$\beta_{eff}$ [pcm]} 
    & \textbf{Diff [pcm]} & \textbf{Total $\frac{\Delta \rho}{\Delta T}$ [pcm/K]} 
    & \textbf{Diff [pcm/K]} \\
    \hline 
    OpenMC & No &  653.40 & - &  \Minus3.63 & - \\ 
    Moltres & Yes & 652.57 & \Minus0.84 & \Minus4.06 & \Minus0.43\\ 
    \hline
    \end{tabular}
\end{table}

\paragraph{Flux Distribution}
The $\epsilon_{f,g}$ and $\Sigma_{f,g}$ terms in the Moltres source term (Equation 
\ref{eq:moltres-source-term}) are provided to Moltres through 
the group constants generated by neutronics software, OpenMC.
Thus, differences in the source term between OpenMC and Moltres are dependent on 
the flux. 
Comparison of flux distributions produced by Moltres and OpenMC are key to ensuring 
that Moltres accurately calculates the temperature distribution.

Figure \ref{fig:flux_948K_full_assem} shows the 4-group flux distributions for OpenMC and 
Moltres models' on the \gls{AHTR} assembly's centerline, along the y-axis at 
the x-axis' midpoint (white line on Figure \ref{fig:assembly_mg}). 
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.48\linewidth]{flux_group1_948K_full_assem.png} 
    \includegraphics[width=0.48\linewidth]{flux_group2_948K_full_assem.png} 
    \includegraphics[width=0.48\linewidth]{flux_group3_948K_full_assem.png} 
    \includegraphics[width=0.48\linewidth]{flux_group4_948K_full_assem.png} 
    \caption{\acrfull{AHTR} assembly's centerline neutron flux distribution 
    in 4 groups at 948K (discretized into 1000 points). 
    Centerline is the white line in Figure \ref{fig:assembly_mg}.
    Comparison is between OpenMC simulation with continuous energy 
    and TRISO-level spatial fidelity and Moltres simulation with 4-group energy and 
    spatial homogenization.
    Energy Group 1: E $> 9.1188 \times 10^{-3}$ MeV, 
    Energy Group 2: $2.9023 \times 10^{-5} < E < 9.1188 \times 10^{-3}$ MeV,
    Energy Group 3:  $1.8556 \times 10^{-5} < E < 2.9023 \times 10^{-5}$ MeV,
    Energy Group 4:  $1.0 \times 10^{-12} < E < 1.8554 \times 10^{-6}$ MeV.}
    \label{fig:flux_948K_full_assem}
\end{figure}
Table \ref{tab:ahtr-full-assem-verification-flux} reports the 2-norm percentage 
difference (Equation \ref{eq:ahtr-assem-flux-2norm}) and maximum percentage 
difference between centerline flux values from OpenMC and Moltres models. 
\begin{align}
    \label{eq:ahtr-assem-flux-2norm}
    ||\Delta \phi||_N &= \frac{1}{N}\sqrt{\sum_{i=1}^N(\frac{\phi_{moltres, i} - \phi_{openmc, i}}{\phi_{openmc, i}}\times100)^2} \\
\intertext{where}
    ||\Delta \phi||_N &= \mbox{normalized 2-norm flux percentage difference between Moltres and OpenMC } [\%] \nonumber \\
    N &= \mbox{total number of discretized points} \nonumber \\
    \phi_{moltres} &= \mbox{Moltres model's centerline flux } [\frac{n}{cm^2s}] \nonumber \\
    \phi_{openmc} &= \mbox{OpenMC model's centerline flux } [\frac{n}{cm^2s}] \nonumber 
\end{align} 
\begin{table}[htbp]
    \centering
    \onehalfspacing
    \caption{\acrfull{AHTR} assembly's centerline normalized 2-norm of flux percentage 
    difference and maximum flux percentage difference. 
    Centerline is the white line in Figure \ref{fig:assembly_mg}.
    The difference values are calculated from comparison between the OpenMC simulation with 
    continuous energy and TRISO-level spatial fidelity and Moltres simulation with 4-group energy 
    and spatial homogenization.}
	\label{tab:ahtr-full-assem-verification-flux}
    \footnotesize
    \begin{tabular}{lll}
    \hline 
    \textbf{Energy Group}& \textbf{2-norm difference [$\%$]}& \textbf{Max difference [$\%$]} \\
    \hline 
    1 & 0.13 & \Minus10.57 \\
    2 & 0.08 & \Plus7.58 \\
    3 & 0.10 & \Plus8.96 \\
    4 & 0.09 & \Plus6.97 \\
    \hline
    \end{tabular}
\end{table}

Figure \ref{fig:flux_948K_full_assem} shows that the OpenMC model has good flux 
agreement for all groups. 
Table \ref{tab:ahtr-plank-verification-flux} shows that the 2-norm percentage differences 
between OpenMC and Moltres models' flux values are slight, demonstrating a 
good overall agreement for each group's flux.
The large maximum percentage difference in flux values in Group 2 and 3 is attributed to 
their resonance regions, causing large one-off differences at some discretized points.
The flux neutronics parameter is most important as it contributes to the source term in the 
Moltres simulation. 
Thus, these accurate flux comparison results verify the accurate calculation 
of the temperature distribution in the Moltres \gls{AHTR} full assembly model. 

\paragraph{Neutron Energy Spectrum}
Figure \ref{fig:neutron_spectrum_948K_full_assem} shows the neutron spectrum of the 
OpenMC simulation for both 252 and 4 groups and the 4-group Moltres simulation.
 \begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{neutron_spectrum_948K_full_assem.png}
    \caption{\acrfull{AHTR} full assembly's neutron spectrum. Spectrums include 252 
    and 4 group spectrums from OpenMC simulation with continuous energy and 
    TRISO-level spatial fidelity and 4 group spectrum from Moltres simulation with 
    4-group energy and spatial homogenization.}  
    \label{fig:neutron_spectrum_948K_full_assem}
\end{figure}
There is good agreement between OpenMC and Moltres models 4-group spectrums. 

In summary, Moltres replicated the relevant neutronics parameters with sufficient 
accuracy using OpenMC's group constant data for the \gls{AHTR} full assembly 
model. 

\subsection{FHR Benchmark: Moltres Mesh Generation}
I created an \gls{AHTR} assembly geometry file (\texttt{.geo}) based on the spatial 
homogenization described in Section \ref{sec:fhr-bm-group-constant}.
The \gls{AHTR} mesh is then generated from the geometry file using Gmsh 
\cite{geuzaine_gmsh_2009}.
I used Gmsh's \textit{refine by splitting} functionality to refine the mesh.
Figure \ref{fig:ahtr-full-assem-geo} shows the \gls{AHTR} assembly's Gmsh rendered 
geometry file.
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{ahtr-full-assem-geo.png}
    \caption{\acrfull{AHTR} assembly's Gmsh rendered geometry file. 
    I meshed the geometry file using Gmsh.
    The mesh file is used in the \gls{AHTR} assembly Moltres temperature model.}
    \label{fig:ahtr-full-assem-geo}
\end{figure}

\pagebreak
\subsubsection{FHR Benchmark: Mesh Refinement Study}
I performed a mesh refinement study on the \gls{AHTR} full assembly Moltres temperature 
model to ensure that the geometry mesh inputs are sufficiently converged. 
Table \ref{tab:ahtr-full-assem-mesh-refinement} reports the average, maximum, and 
normalized 2-norm of discretized temperature difference between refinement steps 
(Equation \ref{eq:2-norm-tdiff-i-full-assem}):
\begin{align}
    \label{eq:2-norm-tdiff-i-full-assem}
    ||\Delta T_k||_N &= \frac{1}{N}\sqrt{\sum_{i=1}^N(T_{k-1, i} - T_{k, i})^2 }\\
\intertext{where}
    ||\Delta T_k||_N &= \mbox{normalized 2-norm discretized temperature difference 
    between refinement steps } [K]\nonumber \\
    N &= \mbox{total number of discretized points} \nonumber \\
    k &= \mbox{refinement step} \nonumber \\
    T_{k-1} &= \mbox{temperatures from previous refinement step } [K]\nonumber \\
    T &= \mbox{temperatures from current refinement step } [K]\nonumber 
\end{align} 
\begin{table}[htbp]
    \centering
    \onehalfspacing
    \caption{\acrfull{AHTR} full assembly's Moltres temperature model's mesh refinement study.}
	\label{tab:ahtr-full-assem-mesh-refinement}
    \footnotesize
    \begin{tabular}{lp{3.5cm}lp{3.5cm}ll}
        \hline 
        \textbf{Refinement} & \textbf{Max Assembly Temp [K]} 
        & \textbf{Diff [K]} & \textbf{Ave Assembly Temp [K]}
        & \textbf{Diff [K]} & $||\Delta T_k||_N$ [K]\\ 
        \hline 
        1 & 1040.931 & - & 960.619 & - & -\\
        2 & 1048.941 & \Plus8.010 & 962.854 & \Plus2.235 & 0.175\\
        3 & 1057.403 & \Plus8.463 & 963.948 & \Plus1.093 & 0.067\\
        4 & 1061.599 & \Plus4.196 & 965.020 & \Plus1.073 & 0.053\\
        \hline
    \end{tabular}
\end{table}

The mesh refinement study shows suitable $||\Delta T_k||_N$ convergence with more 
refinement steps. 
Therefore, I used x4 mesh refinement for the \gls{AHTR} full assembly Moltres 
temperature model. 

\subsection{FHR Benchmark: Temperature Model}
\label{sec:fhr-benchmark-temp-model}
The Moltres \gls{AHTR} steady-state temperature model is a 2D x-y cross-section 
model of the \gls{AHTR} assembly. 
The Moltres temperature model first solves the \gls{AHTR} neutronics and uses that to 
solve the \gls{AHTR}'s temperature distribution for a defined power.
The temperature model assumes conductive heat transfer throughout the domain 
and heat removal by uniform salt flow in the coolant regions. 
These assumptions ignore turbulent effects that would most likely be present. 
However, an in-depth AHTR Moltres model that includes turbulence modeling is 
out of scope for this dissertation. 

\subsubsection{FHR Benchmark: Temperature Model Setup}
Moltres solves the four-group diffusion equations 
(Equation \ref{eq:moltres-diffusion-equation}) 
as a steady-state eigenvalue problem to find $k_{eff}$ for the static \gls{AHTR} models.
In the 2D cross-sectional \gls{AHTR} steady-state temperature model, I ignore the 
time-dependent and velocity-dependent terms from Moltres' temperature governing 
equation (Equation \ref{eq:moltres-temp}) since it is a steady-state model with
no moving fuel, resulting in Equation \ref{eq:moltres-temp-ss-bm}: 
\begin{align}
    \label{eq:moltres-temp-ss-bm}
    - \nabla \cdot (k_i \nabla T) &= Q_i
\intertext{where}
k_i &= \mbox{thermal conductivity of material i} \nonumber \\
T &= \mbox{temperature in the model} \nonumber \\
Q_i &= \mbox{source or sink term in material i} \nonumber
\end{align} 
I use insulated temperature boundary conditions.  
Table \ref{tab:ahtr-thermal-conductivity-bm} shows the thermal conductivity values 
used for each \gls{AHTR} material. 
\begin{table}[htbp]
    \centering
    \onehalfspacing
    \caption{\acrfull{AHTR} materials' thermal conductivities used in Moltres 
    temperature models, taken from \cite{ramey_methodology_2021}.}
	\label{tab:ahtr-thermal-conductivity-bm}
    \footnotesize
    \begin{tabular}{ll}
    \hline 
    \textbf{Material}& \textbf{Thermal Conductivity} \\
    & [$Wcm^{-1}K^{-1}$] \\ 
    \hline 
    \gls{FLiBe} & 0.01 \\
    Graphite  & 0.15 \\
    Fuel  & 0.099 \\
    \hline
    \end{tabular}
\end{table}

Equation \ref{eq:moltres-source-term-bm} defines the fuel cells' fission source term 
($Q_f$):
\begin{align}
\label{eq:moltres-source-term-bm}
    Q_f &= \sum_{g=1}^G \epsilon_{f,g}\Sigma_{f,g}\phi_g
\intertext{where} 
Q_f &= \mbox{source term } [\frac{MeV}{cm^3s}] \nonumber \\
G &= \mbox{number of discrete groups, g } [-] \nonumber \\
\epsilon_{f,g} &= \mbox{heat produced per fission } [MeV] \nonumber \\
\Sigma_{f,g} &= \mbox{macroscopic cross section for fission due to neutrons in group g } [\frac{1}{cm}] \nonumber \\
\phi_g &= \mbox{flux of neutrons in group g } [\frac{n}{cm^2s}]\nonumber
\end{align}

Equation \ref{eq:moltres-heat-removal-bm} defines the heat removal from the AHTR 
model:
\begin{align}
    \label{eq:moltres-heat-removal-bm}
    Q &= h \cdot A \cdot(T(\vec{r})-T_{ref})
\intertext{where}
Q &= \mbox{heat removal rate for 1cm thin slice of the AHTR model [W/cm]} \nonumber \\
h &= \mbox{heat transfer coefficient } [\frac{W}{cm^3 \cdot K}] \nonumber \\
A &= \mbox{coolant area } [cm^2] \nonumber \\
T(\vec{r}) &= \mbox{temperature at point $\vec{r}$ [K]} \nonumber \\
T_{ref} &= \mbox{reference temperature [K]} \nonumber
\end{align}

Table \ref{tab:heat-exchanger-constants-bm} shows reference temperature and heat 
transfer coefficient values for the convective heat transfer process.
\begin{table}[htbp]
    \centering
    \onehalfspacing
    \caption{\acrfull{AHTR} assembly heat transfer constants for Moltres temperature 
    model.}
	\label{tab:heat-exchanger-constants-bm}
    \footnotesize
    \begin{tabular}{llll}
    \hline 
    \textbf{Constant}& \textbf{Value}& \textbf{Units} & \textbf{Notes} \\
    \hline 
    $h_{assem}$ & 611 & $\frac{W}{cm \cdot K}$ & Calculated in Eq. \ref{eq:calc-htc-full-assem} \\
    $T_{ref}$ & 923 & K & AHTR Inlet Temperature \cite{ramey_methodology_2021} \\ 
    \hline
    \end{tabular}
\end{table} 

I calculated the heat transfer coefficient ($h$) for the \gls{AHTR} assembly
using Equation \ref{eq:calc-htc-full-assem} with the following assumptions: 
\begin{itemize}
    \item AHTR models generate constant amount of power, which is all removed by the 
    coolant
    \item a linear increase in temperature from inlet to outlet 
\end{itemize}
\begin{align}
      \label{eq:calc-htc-full-assem}
      h_{assem} &= \frac{P_{dz}}{V_{coolant}} \div \Delta T \\
      &= \frac{26223 W/cm}{471cm^3} \div 0.0909 K/cm \nonumber \\
      &= 611 W cm^{-3}K^{-1} \nonumber 
\intertext{and}
\Delta T  &= \frac{T_{total}}{H} = \frac{50 K}{550 cm} = 0.0909 K/cm
\intertext{where}
h_{assem} &= \mbox{assembly's heat transfer coefficient } [\frac{W}{cm^3 \cdot K}] \nonumber \\
P_{dz} &= \mbox{power produced in 1cm AHTR assembly $\Delta z$ slice [$W/cm$]}\nonumber \\
V_{coolant} &= \mbox{coolant volume in AHTR assembly [$cm^3$]} \nonumber \\
\Delta T &= \mbox{temperature change across 1cm AHTR assembly $\Delta z$ slice [$K$]}\\
T_{total} &= \mbox{total temperature change from inlet to outlet [$K$]} \nonumber \\
H &= \mbox{AHTR height from inlet to outlet [cm]} \nonumber 
\end{align}
The power produced by the \gls{AHTR} assembly model is calculated based 
on the \gls{FHR} benchmark model's specific power of 200 $\frac{W}{gU}$ and the FHR 
benchmark's TRISO packing fractions in a 1cm thick slice of the assembly.

\subsubsection{FHR Benchmark: Temperature Model Results}
Figure \ref{fig:benchmark-temperature-model} shows the 2D temperature distribution in the 
\gls{AHTR} assembly.  
\begin{figure}[htbp]
    \centering
    \includegraphics[width=\linewidth]{benchmark-temperature-model.png} 
    \caption{2D temperature distribution in the \acrfull{AHTR} full assembly generated 
    by Moltres.}
    \label{fig:benchmark-temperature-model}
\end{figure}
The average temperature distribution across the fuel planks are similar at approximately 
1025K, while the graphite structure has an average temperature of approximately 935K. 
As defined in the temperature model setup, the \gls{FLiBe} coolant channel 
(inter-plank, inter-assembly, control rod slot) regions remain at 923K.
The temperature peaks at 1062K, which occur in the fuel stripes near the spacers. 
This could be due to the extra moderation provided by the graphite spacers.
This highlights the significance of the spacers' material composition and location in 
causing higher temperature peaks. 

\pagebreak
\section{Summary}
\glsresetall
This chapter described the \gls{FHR} benchmark specifications, \gls{AHTR} design,
Phase I-A and I-B results obtained by the \gls{UIUC} team, and the \gls{FHR} 
temperature model's results.  
The benchmark results highlight the \gls{AHTR}'s passive safety behavior with 
negative temperature coefficients. 
Results such as a lower $k_{eff}$ for the \gls{AHTR} configuration with 
higher heavy metal loading demonstrated that increased fuel packing does not always 
correspond with increased $k_{eff}$ due to self-shielding effects.
These results hint at the possibility of minimizing fuel required by optimizing 
for heterogenous fuel distributions within the core. 
This will be further explored in the later chapters. 
The temperature model demonstrates that the \gls{AHTR}'s temperature peaks are in the 
fuel stripes near the spacers, highlighting to reactor designers that 
spacer material and location in the \gls{AHTR} geometry impact temperature peaks. 
